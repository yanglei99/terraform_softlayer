{"paragraphs":[{"text":"%spark.dep\nz.reset()","user":"anonymous","dateUpdated":"2017-06-24T18:09:49-0400","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Must be used before SparkInterpreter (%spark) initialized\nHint: put this paragraph before any Spark code and restart Zeppelin/Interpreter"}]},"apps":[],"jobName":"paragraph_1498317615253_-806336593","id":"20170428-134011_1331028414","dateCreated":"2017-06-24T11:20:15-0400","dateStarted":"2017-06-24T18:09:49-0400","dateFinished":"2017-06-24T18:09:49-0400","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6980"},{"text":"\nval fileName = \"/Users/yanglei/Documents/source/terraform/softlayer/execution/spark_xgboost/XGBoost/lending/input/loan_sub_new.csv\"\nvar df_data_1 = sqlContext.read.option(\"header\", \"true\").option(\"mode\", \"DROPMALFORMED\").option(\"inferSchema\", \"true\").csv(fileName)\n    \ndf_data_1.printSchema()\ndf_data_1.show()\n","user":"anonymous","dateUpdated":"2017-06-24T20:45:48-0400","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nfileName: String = /Users/yanglei/Documents/source/terraform/softlayer/execution/spark_xgboost/XGBoost/lending/input/loan_sub_new.csv\n\ndf_data_1: org.apache.spark.sql.DataFrame = [id: int, member_id: int ... 22 more fields]\nroot\n |-- id: integer (nullable = true)\n |-- member_id: integer (nullable = true)\n |-- loan_status: string (nullable = true)\n |-- loan_amnt: integer (nullable = true)\n |-- term: string (nullable = true)\n |-- int_rate: double (nullable = true)\n |-- verification_status: string (nullable = true)\n |-- purpose: string (nullable = true)\n |-- policy_code: integer (nullable = true)\n |-- application_type: string (nullable = true)\n |-- home_ownership: string (nullable = true)\n |-- annual_inc: double (nullable = true)\n |-- addr_state: string (nullable = true)\n |-- dti: double (nullable = true)\n |-- delinq_2yrs: integer (nullable = true)\n |-- mths_since_last_delinq: integer (nullable = true)\n |-- total_acc: integer (nullable = true)\n |-- inq_last_6mths: integer (nullable = true)\n |-- mths_since_last_record: integer (nullable = true)\n |-- open_acc: integer (nullable = true)\n |-- pub_rec: integer (nullable = true)\n |-- collections_12_mths_ex_med: integer (nullable = true)\n |-- acc_now_delinq: integer (nullable = true)\n |-- default: string (nullable = true)\n\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+\n|     id|member_id|loan_status|loan_amnt|      term|int_rate|verification_status|           purpose|policy_code|application_type|home_ownership|annual_inc|addr_state|  dti|delinq_2yrs|mths_since_last_delinq|total_acc|inq_last_6mths|mths_since_last_record|open_acc|pub_rec|collections_12_mths_ex_med|acc_now_delinq|    default|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+\n|1068545|  1303147| Fully Paid|     7000| 36 months|   11.71|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|           OWN|   39120.0|        FL|21.01|          0|                    26|       26|             0|                    33|       8|      1|                         0|             0|non-default|\n|1062177|  1294027| Fully Paid|    15000| 36 months|   17.27|    Source Verified|             59.83|          1|      INDIVIDUAL|      MORTGAGE|   44400.0|        FL| 3.59|          1|                    18|       16|             0|                    93|       6|      1|                         0|             0|non-default|\n|1066424|  1291243| Fully Paid|     5500| 36 months|     7.9|    Source Verified|               car|          1|      INDIVIDUAL|           OWN|   59000.0|        PA| 6.65|          0|                    35|       23|             0|                    52|      10|      1|                         0|             0|non-default|\n|1064908|  1298959| Fully Paid|     9000| 36 months|   14.65|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   45000.0|        NY|17.01|          1|                    20|       51|             1|                    85|      21|      1|                         0|             0|non-default|\n|1064623|  1298440| Fully Paid|     5600| 36 months|   10.65|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        CA|16.36|          1|                     4|       25|             0|                    90|      11|      1|                         0|             0|non-default|\n|1062384|  1294244| Fully Paid|     2400| 36 months|   12.69|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   59393.0|        OR| 13.7|          0|                    50|       18|             1|                    45|      12|      1|                         0|             0|non-default|\n|1061842|  1293470| Fully Paid|    20000| 60 months|   19.03|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  130000.0|        AZ| 9.06|          0|                    26|       25|             0|                    91|       9|      1|                         0|             0|non-default|\n|1060372|  1292123| Fully Paid|     7200| 36 months|     7.9|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   34000.0|        CT|17.51|          0|                    77|       13|             0|                    38|      10|      1|                         0|             0|non-default|\n|1052333|  1283889| Fully Paid|    15000| 36 months|   12.42|           Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   73600.0|        CO|11.67|          0|                    61|       25|             0|                   101|      11|      1|                         0|             0|non-default|\n|1046355|  1277399| Fully Paid|     8575| 36 months|   15.27|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   35000.0|        MI|24.58|          0|                    68|       30|             2|                    88|      16|      1|                         0|             0|non-default|\n|1051570|  1282673| Fully Paid|     5400| 36 months|     7.9|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   38000.0|        NV|17.31|          0|                    52|       22|             0|                   114|      10|      1|                         0|             0|non-default|\n|1051355|  1282656|Charged Off|     6000| 36 months|   15.96|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   39168.0|        CA|24.85|          0|                    36|       30|             1|                    77|      13|      1|                         0|             0|    default|\n|1051000|  1282460| Fully Paid|    10000| 36 months|   12.69|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|  200000.0|        CO|18.88|          0|                    57|       46|             1|                   110|      16|      1|                         0|             0|non-default|\n|1051194|  1282282| Fully Paid|     7000| 36 months|   16.77|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   52000.0|        MN|17.42|          0|                    29|       23|             2|                   102|       9|      1|                         0|             0|non-default|\n|1045034|  1275430| Fully Paid|     1800| 36 months|   11.71|       Not Verified|           medical|          1|      INDIVIDUAL|          RENT|   49000.0|        MI|15.33|          0|                    59|       16|             1|                    96|       5|      1|                         0|             0|non-default|\n|1044439|  1274787| Fully Paid|     9000| 36 months|   16.29|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   84500.0|        LA|13.97|          0|                    41|       16|             1|                   107|       8|      1|                         0|             0|non-default|\n|1044042|  1274378|Charged Off|    14000| 60 months|   17.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   43000.0|        GA|17.97|          0|                    30|       31|             1|                    85|      17|      1|                         0|             0|    default|\n|1042610|  1272674| Fully Paid|    30000| 60 months|   15.96|           Verified|  home_improvement|          1|      INDIVIDUAL|      MORTGAGE|  55097.04|        GA|16.64|          0|                    76|       23|             1|                   117|       7|      1|                         0|             0|non-default|\n|1037138|  1267030|Charged Off|    15000| 60 months|   12.69|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        NJ| 4.68|          0|                    71|       13|             2|                   111|       8|      1|                         0|             0|    default|\n|1040635|  1270616| Fully Paid|     5400| 36 months|   15.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  112000.0|        FL|13.17|          0|                    25|       32|             3|                   108|      11|      1|                         0|             0|non-default|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1498317615260_-809029836","id":"20170428-135609_1789536728","dateCreated":"2017-06-24T11:20:15-0400","dateStarted":"2017-06-24T20:45:48-0400","dateFinished":"2017-06-24T20:45:49-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6981"},{"text":"//Convert label into label indices using the StringIndexer\n\nimport org.apache.spark.ml.feature.StringIndexer\n\nval label_stringIdx = new StringIndexer()\n  .setInputCol(\"default\")\n  .setOutputCol(\"label\")\n\ndf_data_1 = label_stringIdx.fit(df_data_1).transform(df_data_1)\n\ndf_data_1.printSchema()\ndf_data_1.show()\n","user":"anonymous","dateUpdated":"2017-06-24T20:45:52-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.feature.StringIndexer\n\nlabel_stringIdx: org.apache.spark.ml.feature.StringIndexer = strIdx_de6616bbd750\n\ndf_data_1: org.apache.spark.sql.DataFrame = [id: int, member_id: int ... 23 more fields]\nroot\n |-- id: integer (nullable = true)\n |-- member_id: integer (nullable = true)\n |-- loan_status: string (nullable = true)\n |-- loan_amnt: integer (nullable = true)\n |-- term: string (nullable = true)\n |-- int_rate: double (nullable = true)\n |-- verification_status: string (nullable = true)\n |-- purpose: string (nullable = true)\n |-- policy_code: integer (nullable = true)\n |-- application_type: string (nullable = true)\n |-- home_ownership: string (nullable = true)\n |-- annual_inc: double (nullable = true)\n |-- addr_state: string (nullable = true)\n |-- dti: double (nullable = true)\n |-- delinq_2yrs: integer (nullable = true)\n |-- mths_since_last_delinq: integer (nullable = true)\n |-- total_acc: integer (nullable = true)\n |-- inq_last_6mths: integer (nullable = true)\n |-- mths_since_last_record: integer (nullable = true)\n |-- open_acc: integer (nullable = true)\n |-- pub_rec: integer (nullable = true)\n |-- collections_12_mths_ex_med: integer (nullable = true)\n |-- acc_now_delinq: integer (nullable = true)\n |-- default: string (nullable = true)\n |-- label: double (nullable = true)\n\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+\n|     id|member_id|loan_status|loan_amnt|      term|int_rate|verification_status|           purpose|policy_code|application_type|home_ownership|annual_inc|addr_state|  dti|delinq_2yrs|mths_since_last_delinq|total_acc|inq_last_6mths|mths_since_last_record|open_acc|pub_rec|collections_12_mths_ex_med|acc_now_delinq|    default|label|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+\n|1068545|  1303147| Fully Paid|     7000| 36 months|   11.71|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|           OWN|   39120.0|        FL|21.01|          0|                    26|       26|             0|                    33|       8|      1|                         0|             0|non-default|  0.0|\n|1062177|  1294027| Fully Paid|    15000| 36 months|   17.27|    Source Verified|             59.83|          1|      INDIVIDUAL|      MORTGAGE|   44400.0|        FL| 3.59|          1|                    18|       16|             0|                    93|       6|      1|                         0|             0|non-default|  0.0|\n|1066424|  1291243| Fully Paid|     5500| 36 months|     7.9|    Source Verified|               car|          1|      INDIVIDUAL|           OWN|   59000.0|        PA| 6.65|          0|                    35|       23|             0|                    52|      10|      1|                         0|             0|non-default|  0.0|\n|1064908|  1298959| Fully Paid|     9000| 36 months|   14.65|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   45000.0|        NY|17.01|          1|                    20|       51|             1|                    85|      21|      1|                         0|             0|non-default|  0.0|\n|1064623|  1298440| Fully Paid|     5600| 36 months|   10.65|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        CA|16.36|          1|                     4|       25|             0|                    90|      11|      1|                         0|             0|non-default|  0.0|\n|1062384|  1294244| Fully Paid|     2400| 36 months|   12.69|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   59393.0|        OR| 13.7|          0|                    50|       18|             1|                    45|      12|      1|                         0|             0|non-default|  0.0|\n|1061842|  1293470| Fully Paid|    20000| 60 months|   19.03|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  130000.0|        AZ| 9.06|          0|                    26|       25|             0|                    91|       9|      1|                         0|             0|non-default|  0.0|\n|1060372|  1292123| Fully Paid|     7200| 36 months|     7.9|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   34000.0|        CT|17.51|          0|                    77|       13|             0|                    38|      10|      1|                         0|             0|non-default|  0.0|\n|1052333|  1283889| Fully Paid|    15000| 36 months|   12.42|           Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   73600.0|        CO|11.67|          0|                    61|       25|             0|                   101|      11|      1|                         0|             0|non-default|  0.0|\n|1046355|  1277399| Fully Paid|     8575| 36 months|   15.27|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   35000.0|        MI|24.58|          0|                    68|       30|             2|                    88|      16|      1|                         0|             0|non-default|  0.0|\n|1051570|  1282673| Fully Paid|     5400| 36 months|     7.9|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   38000.0|        NV|17.31|          0|                    52|       22|             0|                   114|      10|      1|                         0|             0|non-default|  0.0|\n|1051355|  1282656|Charged Off|     6000| 36 months|   15.96|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   39168.0|        CA|24.85|          0|                    36|       30|             1|                    77|      13|      1|                         0|             0|    default|  1.0|\n|1051000|  1282460| Fully Paid|    10000| 36 months|   12.69|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|  200000.0|        CO|18.88|          0|                    57|       46|             1|                   110|      16|      1|                         0|             0|non-default|  0.0|\n|1051194|  1282282| Fully Paid|     7000| 36 months|   16.77|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   52000.0|        MN|17.42|          0|                    29|       23|             2|                   102|       9|      1|                         0|             0|non-default|  0.0|\n|1045034|  1275430| Fully Paid|     1800| 36 months|   11.71|       Not Verified|           medical|          1|      INDIVIDUAL|          RENT|   49000.0|        MI|15.33|          0|                    59|       16|             1|                    96|       5|      1|                         0|             0|non-default|  0.0|\n|1044439|  1274787| Fully Paid|     9000| 36 months|   16.29|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   84500.0|        LA|13.97|          0|                    41|       16|             1|                   107|       8|      1|                         0|             0|non-default|  0.0|\n|1044042|  1274378|Charged Off|    14000| 60 months|   17.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   43000.0|        GA|17.97|          0|                    30|       31|             1|                    85|      17|      1|                         0|             0|    default|  1.0|\n|1042610|  1272674| Fully Paid|    30000| 60 months|   15.96|           Verified|  home_improvement|          1|      INDIVIDUAL|      MORTGAGE|  55097.04|        GA|16.64|          0|                    76|       23|             1|                   117|       7|      1|                         0|             0|non-default|  0.0|\n|1037138|  1267030|Charged Off|    15000| 60 months|   12.69|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        NJ| 4.68|          0|                    71|       13|             2|                   111|       8|      1|                         0|             0|    default|  1.0|\n|1040635|  1270616| Fully Paid|     5400| 36 months|   15.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  112000.0|        FL|13.17|          0|                    25|       32|             3|                   108|      11|      1|                         0|             0|non-default|  0.0|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1498340247199_-1912188352","id":"20170624-173727_933436512","dateCreated":"2017-06-24T17:37:27-0400","dateStarted":"2017-06-24T20:45:52-0400","dateFinished":"2017-06-24T20:45:53-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6982"},{"text":"// One-hot encoder for all strings\n\nimport org.apache.spark.ml.feature.OneHotEncoder\n\nval categoricalColumns = Array(\"term\", \"home_ownership\", \"verification_status\", \"purpose\", \"addr_state\")\n\nfor (categoricalCol <- categoricalColumns)\n{\n   var strIndex =  new StringIndexer()\n            .setInputCol(categoricalCol)\n            .setOutputCol(categoricalCol+\"Index\")\n   var  oneHotEncoder = new OneHotEncoder()\n            .setInputCol(categoricalCol+\"Index\")\n            .setOutputCol(categoricalCol+\"classVec\")\n            \n   df_data_1 = strIndex.fit(df_data_1).transform(df_data_1)\n   df_data_1 = oneHotEncoder.transform(df_data_1)  \n}\n\ndf_data_1.printSchema()\ndf_data_1.show()","user":"anonymous","dateUpdated":"2017-06-24T20:45:57-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.feature.OneHotEncoder\n\ncategoricalColumns: Array[String] = Array(term, home_ownership, verification_status, purpose, addr_state)\nroot\n |-- id: integer (nullable = true)\n |-- member_id: integer (nullable = true)\n |-- loan_status: string (nullable = true)\n |-- loan_amnt: integer (nullable = true)\n |-- term: string (nullable = true)\n |-- int_rate: double (nullable = true)\n |-- verification_status: string (nullable = true)\n |-- purpose: string (nullable = true)\n |-- policy_code: integer (nullable = true)\n |-- application_type: string (nullable = true)\n |-- home_ownership: string (nullable = true)\n |-- annual_inc: double (nullable = true)\n |-- addr_state: string (nullable = true)\n |-- dti: double (nullable = true)\n |-- delinq_2yrs: integer (nullable = true)\n |-- mths_since_last_delinq: integer (nullable = true)\n |-- total_acc: integer (nullable = true)\n |-- inq_last_6mths: integer (nullable = true)\n |-- mths_since_last_record: integer (nullable = true)\n |-- open_acc: integer (nullable = true)\n |-- pub_rec: integer (nullable = true)\n |-- collections_12_mths_ex_med: integer (nullable = true)\n |-- acc_now_delinq: integer (nullable = true)\n |-- default: string (nullable = true)\n |-- label: double (nullable = true)\n |-- termIndex: double (nullable = true)\n |-- termclassVec: vector (nullable = true)\n |-- home_ownershipIndex: double (nullable = true)\n |-- home_ownershipclassVec: vector (nullable = true)\n |-- verification_statusIndex: double (nullable = true)\n |-- verification_statusclassVec: vector (nullable = true)\n |-- purposeIndex: double (nullable = true)\n |-- purposeclassVec: vector (nullable = true)\n |-- addr_stateIndex: double (nullable = true)\n |-- addr_stateclassVec: vector (nullable = true)\n\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+---------+-------------+-------------------+----------------------+------------------------+---------------------------+------------+---------------+---------------+------------------+\n|     id|member_id|loan_status|loan_amnt|      term|int_rate|verification_status|           purpose|policy_code|application_type|home_ownership|annual_inc|addr_state|  dti|delinq_2yrs|mths_since_last_delinq|total_acc|inq_last_6mths|mths_since_last_record|open_acc|pub_rec|collections_12_mths_ex_med|acc_now_delinq|    default|label|termIndex| termclassVec|home_ownershipIndex|home_ownershipclassVec|verification_statusIndex|verification_statusclassVec|purposeIndex|purposeclassVec|addr_stateIndex|addr_stateclassVec|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+---------+-------------+-------------------+----------------------+------------------------+---------------------------+------------+---------------+---------------+------------------+\n|1068545|  1303147| Fully Paid|     7000| 36 months|   11.71|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|           OWN|   39120.0|        FL|21.01|          0|                    26|       26|             0|                    33|       8|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                2.0|         (3,[2],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            2.0|    (49,[2],[1.0])|\n|1062177|  1294027| Fully Paid|    15000| 36 months|   17.27|    Source Verified|             59.83|          1|      INDIVIDUAL|      MORTGAGE|   44400.0|        FL| 3.59|          1|                    18|       16|             0|                    93|       6|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|        14.0|     (14,[],[])|            2.0|    (49,[2],[1.0])|\n|1066424|  1291243| Fully Paid|     5500| 36 months|     7.9|    Source Verified|               car|          1|      INDIVIDUAL|           OWN|   59000.0|        PA| 6.65|          0|                    35|       23|             0|                    52|      10|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                2.0|         (3,[2],[1.0])|                     0.0|              (2,[0],[1.0])|         7.0| (14,[7],[1.0])|           10.0|   (49,[10],[1.0])|\n|1064908|  1298959| Fully Paid|     9000| 36 months|   14.65|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   45000.0|        NY|17.01|          1|                    20|       51|             1|                    85|      21|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|            1.0|    (49,[1],[1.0])|\n|1064623|  1298440| Fully Paid|     5600| 36 months|   10.65|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        CA|16.36|          1|                     4|       25|             0|                    90|      11|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            0.0|    (49,[0],[1.0])|\n|1062384|  1294244| Fully Paid|     2400| 36 months|   12.69|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   59393.0|        OR| 13.7|          0|                    50|       18|             1|                    45|      12|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|         6.0| (14,[6],[1.0])|           19.0|   (49,[19],[1.0])|\n|1061842|  1293470| Fully Paid|    20000| 60 months|   19.03|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  130000.0|        AZ| 9.06|          0|                    26|       25|             0|                    91|       9|      1|                         0|             0|non-default|  0.0|      1.0|    (1,[],[])|                1.0|         (3,[1],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|           12.0|   (49,[12],[1.0])|\n|1060372|  1292123| Fully Paid|     7200| 36 months|     7.9|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   34000.0|        CT|17.51|          0|                    77|       13|             0|                    38|      10|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|           23.0|   (49,[23],[1.0])|\n|1052333|  1283889| Fully Paid|    15000| 36 months|   12.42|           Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   73600.0|        CO|11.67|          0|                    61|       25|             0|                   101|      11|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|           15.0|   (49,[15],[1.0])|\n|1046355|  1277399| Fully Paid|     8575| 36 months|   15.27|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   35000.0|        MI|24.58|          0|                    68|       30|             2|                    88|      16|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            7.0|    (49,[7],[1.0])|\n|1051570|  1282673| Fully Paid|     5400| 36 months|     7.9|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   38000.0|        NV|17.31|          0|                    52|       22|             0|                   114|      10|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|         6.0| (14,[6],[1.0])|           21.0|   (49,[21],[1.0])|\n|1051355|  1282656|Charged Off|     6000| 36 months|   15.96|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   39168.0|        CA|24.85|          0|                    36|       30|             1|                    77|      13|      1|                         0|             0|    default|  1.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            0.0|    (49,[0],[1.0])|\n|1051000|  1282460| Fully Paid|    10000| 36 months|   12.69|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|  200000.0|        CO|18.88|          0|                    57|       46|             1|                   110|      16|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|           15.0|   (49,[15],[1.0])|\n|1051194|  1282282| Fully Paid|     7000| 36 months|   16.77|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   52000.0|        MN|17.42|          0|                    29|       23|             2|                   102|       9|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|           17.0|   (49,[17],[1.0])|\n|1045034|  1275430| Fully Paid|     1800| 36 months|   11.71|       Not Verified|           medical|          1|      INDIVIDUAL|          RENT|   49000.0|        MI|15.33|          0|                    59|       16|             1|                    96|       5|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         6.0| (14,[6],[1.0])|            7.0|    (49,[7],[1.0])|\n|1044439|  1274787| Fully Paid|     9000| 36 months|   16.29|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   84500.0|        LA|13.97|          0|                    41|       16|             1|                   107|       8|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|           31.0|   (49,[31],[1.0])|\n|1044042|  1274378|Charged Off|    14000| 60 months|   17.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   43000.0|        GA|17.97|          0|                    30|       31|             1|                    85|      17|      1|                         0|             0|    default|  1.0|      1.0|    (1,[],[])|                1.0|         (3,[1],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|            6.0|    (49,[6],[1.0])|\n|1042610|  1272674| Fully Paid|    30000| 60 months|   15.96|           Verified|  home_improvement|          1|      INDIVIDUAL|      MORTGAGE|  55097.04|        GA|16.64|          0|                    76|       23|             1|                   117|       7|      1|                         0|             0|non-default|  0.0|      1.0|    (1,[],[])|                0.0|         (3,[0],[1.0])|                     1.0|              (2,[1],[1.0])|         2.0| (14,[2],[1.0])|            6.0|    (49,[6],[1.0])|\n|1037138|  1267030|Charged Off|    15000| 60 months|   12.69|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        NJ| 4.68|          0|                    71|       13|             2|                   111|       8|      1|                         0|             0|    default|  1.0|      1.0|    (1,[],[])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            5.0|    (49,[5],[1.0])|\n|1040635|  1270616| Fully Paid|     5400| 36 months|   15.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  112000.0|        FL|13.17|          0|                    25|       32|             3|                   108|      11|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|            2.0|    (49,[2],[1.0])|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+---------+-------------+-------------------+----------------------+------------------------+---------------------------+------------+---------------+---------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1498341667675_1770879885","id":"20170624-180107_1061537448","dateCreated":"2017-06-24T18:01:07-0400","dateStarted":"2017-06-24T20:45:57-0400","dateFinished":"2017-06-24T20:45:59-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6983"},{"text":"// Assemble feature vector\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nval numericCols = Array(\"loan_amnt\", \"int_rate\", \"annual_inc\", \"dti\", \"delinq_2yrs\", \"mths_since_last_delinq\", \"total_acc\", \"inq_last_6mths\", \"mths_since_last_record\", \"open_acc\", \"pub_rec\", \"collections_12_mths_ex_med\", \"acc_now_delinq\")\n\nval assemblerInputs = categoricalColumns.map(c => c + \"classVec\") ++ numericCols\n\nval assembler = new VectorAssembler().\n  setInputCols(assemblerInputs).\n  setOutputCol(\"features\")\n\ndf_data_1 = assembler.transform(df_data_1)\n\ndf_data_1.printSchema()\ndf_data_1.show()","user":"anonymous","dateUpdated":"2017-06-24T20:46:03-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.feature.VectorAssembler\n\nnumericCols: Array[String] = Array(loan_amnt, int_rate, annual_inc, dti, delinq_2yrs, mths_since_last_delinq, total_acc, inq_last_6mths, mths_since_last_record, open_acc, pub_rec, collections_12_mths_ex_med, acc_now_delinq)\n\nassemblerInputs: Array[String] = Array(termclassVec, home_ownershipclassVec, verification_statusclassVec, purposeclassVec, addr_stateclassVec, loan_amnt, int_rate, annual_inc, dti, delinq_2yrs, mths_since_last_delinq, total_acc, inq_last_6mths, mths_since_last_record, open_acc, pub_rec, collections_12_mths_ex_med, acc_now_delinq)\n\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_98ce86b97d6a\n\ndf_data_1: org.apache.spark.sql.DataFrame = [id: int, member_id: int ... 34 more fields]\nroot\n |-- id: integer (nullable = true)\n |-- member_id: integer (nullable = true)\n |-- loan_status: string (nullable = true)\n |-- loan_amnt: integer (nullable = true)\n |-- term: string (nullable = true)\n |-- int_rate: double (nullable = true)\n |-- verification_status: string (nullable = true)\n |-- purpose: string (nullable = true)\n |-- policy_code: integer (nullable = true)\n |-- application_type: string (nullable = true)\n |-- home_ownership: string (nullable = true)\n |-- annual_inc: double (nullable = true)\n |-- addr_state: string (nullable = true)\n |-- dti: double (nullable = true)\n |-- delinq_2yrs: integer (nullable = true)\n |-- mths_since_last_delinq: integer (nullable = true)\n |-- total_acc: integer (nullable = true)\n |-- inq_last_6mths: integer (nullable = true)\n |-- mths_since_last_record: integer (nullable = true)\n |-- open_acc: integer (nullable = true)\n |-- pub_rec: integer (nullable = true)\n |-- collections_12_mths_ex_med: integer (nullable = true)\n |-- acc_now_delinq: integer (nullable = true)\n |-- default: string (nullable = true)\n |-- label: double (nullable = true)\n |-- termIndex: double (nullable = true)\n |-- termclassVec: vector (nullable = true)\n |-- home_ownershipIndex: double (nullable = true)\n |-- home_ownershipclassVec: vector (nullable = true)\n |-- verification_statusIndex: double (nullable = true)\n |-- verification_statusclassVec: vector (nullable = true)\n |-- purposeIndex: double (nullable = true)\n |-- purposeclassVec: vector (nullable = true)\n |-- addr_stateIndex: double (nullable = true)\n |-- addr_stateclassVec: vector (nullable = true)\n |-- features: vector (nullable = true)\n\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+---------+-------------+-------------------+----------------------+------------------------+---------------------------+------------+---------------+---------------+------------------+--------------------+\n|     id|member_id|loan_status|loan_amnt|      term|int_rate|verification_status|           purpose|policy_code|application_type|home_ownership|annual_inc|addr_state|  dti|delinq_2yrs|mths_since_last_delinq|total_acc|inq_last_6mths|mths_since_last_record|open_acc|pub_rec|collections_12_mths_ex_med|acc_now_delinq|    default|label|termIndex| termclassVec|home_ownershipIndex|home_ownershipclassVec|verification_statusIndex|verification_statusclassVec|purposeIndex|purposeclassVec|addr_stateIndex|addr_stateclassVec|            features|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+---------+-------------+-------------------+----------------------+------------------------+---------------------------+------------+---------------+---------------+------------------+--------------------+\n|1068545|  1303147| Fully Paid|     7000| 36 months|   11.71|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|           OWN|   39120.0|        FL|21.01|          0|                    26|       26|             0|                    33|       8|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                2.0|         (3,[2],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            2.0|    (49,[2],[1.0])|(82,[0,3,6,22,69,...|\n|1062177|  1294027| Fully Paid|    15000| 36 months|   17.27|    Source Verified|             59.83|          1|      INDIVIDUAL|      MORTGAGE|   44400.0|        FL| 3.59|          1|                    18|       16|             0|                    93|       6|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|        14.0|     (14,[],[])|            2.0|    (49,[2],[1.0])|(82,[0,1,4,22,69,...|\n|1066424|  1291243| Fully Paid|     5500| 36 months|     7.9|    Source Verified|               car|          1|      INDIVIDUAL|           OWN|   59000.0|        PA| 6.65|          0|                    35|       23|             0|                    52|      10|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                2.0|         (3,[2],[1.0])|                     0.0|              (2,[0],[1.0])|         7.0| (14,[7],[1.0])|           10.0|   (49,[10],[1.0])|(82,[0,3,4,13,30,...|\n|1064908|  1298959| Fully Paid|     9000| 36 months|   14.65|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   45000.0|        NY|17.01|          1|                    20|       51|             1|                    85|      21|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|            1.0|    (49,[1],[1.0])|(82,[0,2,4,6,21,6...|\n|1064623|  1298440| Fully Paid|     5600| 36 months|   10.65|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        CA|16.36|          1|                     4|       25|             0|                    90|      11|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            0.0|    (49,[0],[1.0])|(82,[0,2,6,20,69,...|\n|1062384|  1294244| Fully Paid|     2400| 36 months|   12.69|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   59393.0|        OR| 13.7|          0|                    50|       18|             1|                    45|      12|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|         6.0| (14,[6],[1.0])|           19.0|   (49,[19],[1.0])|(82,[0,1,4,12,39,...|\n|1061842|  1293470| Fully Paid|    20000| 60 months|   19.03|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  130000.0|        AZ| 9.06|          0|                    26|       25|             0|                    91|       9|      1|                         0|             0|non-default|  0.0|      1.0|    (1,[],[])|                1.0|         (3,[1],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|           12.0|   (49,[12],[1.0])|(82,[2,5,6,32,69,...|\n|1060372|  1292123| Fully Paid|     7200| 36 months|     7.9|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   34000.0|        CT|17.51|          0|                    77|       13|             0|                    38|      10|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|           23.0|   (49,[23],[1.0])|(82,[0,2,4,6,43,6...|\n|1052333|  1283889| Fully Paid|    15000| 36 months|   12.42|           Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   73600.0|        CO|11.67|          0|                    61|       25|             0|                   101|      11|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|           15.0|   (49,[15],[1.0])|(82,[0,1,5,6,35,6...|\n|1046355|  1277399| Fully Paid|     8575| 36 months|   15.27|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   35000.0|        MI|24.58|          0|                    68|       30|             2|                    88|      16|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            7.0|    (49,[7],[1.0])|(82,[0,2,6,27,69,...|\n|1051570|  1282673| Fully Paid|     5400| 36 months|     7.9|    Source Verified|           medical|          1|      INDIVIDUAL|      MORTGAGE|   38000.0|        NV|17.31|          0|                    52|       22|             0|                   114|      10|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|         6.0| (14,[6],[1.0])|           21.0|   (49,[21],[1.0])|(82,[0,1,4,12,41,...|\n|1051355|  1282656|Charged Off|     6000| 36 months|   15.96|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|   39168.0|        CA|24.85|          0|                    36|       30|             1|                    77|      13|      1|                         0|             0|    default|  1.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            0.0|    (49,[0],[1.0])|(82,[0,1,6,20,69,...|\n|1051000|  1282460| Fully Paid|    10000| 36 months|   12.69|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|      MORTGAGE|  200000.0|        CO|18.88|          0|                    57|       46|             1|                   110|      16|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                0.0|         (3,[0],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|           15.0|   (49,[15],[1.0])|(82,[0,1,4,6,35,6...|\n|1051194|  1282282| Fully Paid|     7000| 36 months|   16.77|    Source Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   52000.0|        MN|17.42|          0|                    29|       23|             2|                   102|       9|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     0.0|              (2,[0],[1.0])|         0.0| (14,[0],[1.0])|           17.0|   (49,[17],[1.0])|(82,[0,2,4,6,37,6...|\n|1045034|  1275430| Fully Paid|     1800| 36 months|   11.71|       Not Verified|           medical|          1|      INDIVIDUAL|          RENT|   49000.0|        MI|15.33|          0|                    59|       16|             1|                    96|       5|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         6.0| (14,[6],[1.0])|            7.0|    (49,[7],[1.0])|(82,[0,2,12,27,69...|\n|1044439|  1274787| Fully Paid|     9000| 36 months|   16.29|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   84500.0|        LA|13.97|          0|                    41|       16|             1|                   107|       8|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|           31.0|   (49,[31],[1.0])|(82,[0,2,6,51,69,...|\n|1044042|  1274378|Charged Off|    14000| 60 months|   17.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   43000.0|        GA|17.97|          0|                    30|       31|             1|                    85|      17|      1|                         0|             0|    default|  1.0|      1.0|    (1,[],[])|                1.0|         (3,[1],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|            6.0|    (49,[6],[1.0])|(82,[2,5,6,26,69,...|\n|1042610|  1272674| Fully Paid|    30000| 60 months|   15.96|           Verified|  home_improvement|          1|      INDIVIDUAL|      MORTGAGE|  55097.04|        GA|16.64|          0|                    76|       23|             1|                   117|       7|      1|                         0|             0|non-default|  0.0|      1.0|    (1,[],[])|                0.0|         (3,[0],[1.0])|                     1.0|              (2,[1],[1.0])|         2.0| (14,[2],[1.0])|            6.0|    (49,[6],[1.0])|(82,[1,5,8,26,69,...|\n|1037138|  1267030|Charged Off|    15000| 60 months|   12.69|       Not Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|   60000.0|        NJ| 4.68|          0|                    71|       13|             2|                   111|       8|      1|                         0|             0|    default|  1.0|      1.0|    (1,[],[])|                1.0|         (3,[1],[1.0])|                     2.0|                  (2,[],[])|         0.0| (14,[0],[1.0])|            5.0|    (49,[5],[1.0])|(82,[2,6,25,69,70...|\n|1040635|  1270616| Fully Paid|     5400| 36 months|   15.27|           Verified|debt_consolidation|          1|      INDIVIDUAL|          RENT|  112000.0|        FL|13.17|          0|                    25|       32|             3|                   108|      11|      1|                         0|             0|non-default|  0.0|      0.0|(1,[0],[1.0])|                1.0|         (3,[1],[1.0])|                     1.0|              (2,[1],[1.0])|         0.0| (14,[0],[1.0])|            2.0|    (49,[2],[1.0])|(82,[0,2,5,6,22,6...|\n+-------+---------+-----------+---------+----------+--------+-------------------+------------------+-----------+----------------+--------------+----------+----------+-----+-----------+----------------------+---------+--------------+----------------------+--------+-------+--------------------------+--------------+-----------+-----+---------+-------------+-------------------+----------------------+------------------------+---------------------------+------------+---------------+---------------+------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1498342776775_944184193","id":"20170624-181936_1641587719","dateCreated":"2017-06-24T18:19:36-0400","dateStarted":"2017-06-24T20:46:03-0400","dateFinished":"2017-06-24T20:46:04-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6984"},{"text":"\ndf_data_1 = df_data_1.select(\"id\",\"label\", \"features\")\ndf_data_1.printSchema()\ndf_data_1.show()","user":"anonymous","dateUpdated":"2017-06-24T20:46:10-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf_data_1: org.apache.spark.sql.DataFrame = [id: int, label: double ... 1 more field]\nroot\n |-- id: integer (nullable = true)\n |-- label: double (nullable = true)\n |-- features: vector (nullable = true)\n\n+-------+-----+--------------------+\n|     id|label|            features|\n+-------+-----+--------------------+\n|1068545|  0.0|(82,[0,3,6,22,69,...|\n|1062177|  0.0|(82,[0,1,4,22,69,...|\n|1066424|  0.0|(82,[0,3,4,13,30,...|\n|1064908|  0.0|(82,[0,2,4,6,21,6...|\n|1064623|  0.0|(82,[0,2,6,20,69,...|\n|1062384|  0.0|(82,[0,1,4,12,39,...|\n|1061842|  0.0|(82,[2,5,6,32,69,...|\n|1060372|  0.0|(82,[0,2,4,6,43,6...|\n|1052333|  0.0|(82,[0,1,5,6,35,6...|\n|1046355|  0.0|(82,[0,2,6,27,69,...|\n|1051570|  0.0|(82,[0,1,4,12,41,...|\n|1051355|  1.0|(82,[0,1,6,20,69,...|\n|1051000|  0.0|(82,[0,1,4,6,35,6...|\n|1051194|  0.0|(82,[0,2,4,6,37,6...|\n|1045034|  0.0|(82,[0,2,12,27,69...|\n|1044439|  0.0|(82,[0,2,6,51,69,...|\n|1044042|  1.0|(82,[2,5,6,26,69,...|\n|1042610|  0.0|(82,[1,5,8,26,69,...|\n|1037138|  1.0|(82,[2,6,25,69,70...|\n|1040635|  0.0|(82,[0,2,5,6,22,6...|\n+-------+-----+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1498343486556_1839554536","id":"20170624-183126_84895126","dateCreated":"2017-06-24T18:31:26-0400","dateStarted":"2017-06-24T20:46:10-0400","dateFinished":"2017-06-24T20:46:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6985"},{"text":"val Array(trainingData, testData) = df_data_1.randomSplit(Array(0.7, 0.3), seed = 824)\nval trainCount = trainingData.count()\nval testCount =  testData.count()\n\nprintln(s\"train:$trainCount, test:$testCount\")","user":"anonymous","dateUpdated":"2017-06-24T20:09:34-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\ntrainingData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [label: double, features: vector]\ntestData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [label: double, features: vector]\n\ntrainCount: Long = 11735\n\ntestCount: Long = 4998\ntrain:11735, test:4998\n"}]},"apps":[],"jobName":"paragraph_1498343630380_1393428058","id":"20170624-183350_659614412","dateCreated":"2017-06-24T18:33:50-0400","dateStarted":"2017-06-24T20:09:34-0400","dateFinished":"2017-06-24T20:09:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6986"},{"text":"// LogisticRegression: you can try other classifiers\nimport org.apache.spark.ml.classification.LogisticRegression\n\nval lr = new LogisticRegression()\n  .setMaxIter(10)\n  .setRegParam(0.3)\n  .setElasticNetParam(0.8)\n  .setFitIntercept(true)\n","user":"anonymous","dateUpdated":"2017-06-24T19:10:22-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.classification.LogisticRegression\n\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_8d2f40e33fa4\n"}]},"apps":[],"jobName":"paragraph_1498344246395_1662444683","id":"20170624-184406_1151037585","dateCreated":"2017-06-24T18:44:06-0400","dateStarted":"2017-06-24T19:10:22-0400","dateFinished":"2017-06-24T19:10:22-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6987"},{"text":"import org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\nval paramGrid = new ParamGridBuilder() \n    .addGrid(lr.regParam, Array(1.0,0.3,0.1, 0.03,0.01,0.0)) \n    .addGrid(lr.elasticNetParam, Array(0.0)) \n    .build()\n\nval evaluator = new BinaryClassificationEvaluator()\n\nval cv = new CrossValidator()\n  .setEstimator(lr)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(paramGrid)\n  .setNumFolds(2)\n  \nval cvModel = cv.fit(trainingData)\nevaluator.evaluate(cvModel.transform(testData))","user":"anonymous","dateUpdated":"2017-06-24T19:17:03-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\n\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nparamGrid: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\tlogreg_8d2f40e33fa4-elasticNetParam: 0.0,\n\tlogreg_8d2f40e33fa4-regParam: 1.0\n}, {\n\tlogreg_8d2f40e33fa4-elasticNetParam: 0.0,\n\tlogreg_8d2f40e33fa4-regParam: 0.3\n}, {\n\tlogreg_8d2f40e33fa4-elasticNetParam: 0.0,\n\tlogreg_8d2f40e33fa4-regParam: 0.1\n}, {\n\tlogreg_8d2f40e33fa4-elasticNetParam: 0.0,\n\tlogreg_8d2f40e33fa4-regParam: 0.03\n}, {\n\tlogreg_8d2f40e33fa4-elasticNetParam: 0.0,\n\tlogreg_8d2f40e33fa4-regParam: 0.01\n}, {\n\tlogreg_8d2f40e33fa4-elasticNetParam: 0.0,\n\tlogreg_8d2f40e33fa4-regParam: 0.0\n})\n\nevaluator: org.apache.spark.ml.evaluation.BinaryClassificationEvaluator = binEval_643204de7e92\n\ncv: org.apache.spark.ml.tuning.CrossValidator = cv_1ec6e4523488\n\ncvModel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_1ec6e4523488\n\nres116: Double = 0.6833290019027004\n"}]},"apps":[],"jobName":"paragraph_1498344443720_49252197","id":"20170624-184723_1734543455","dateCreated":"2017-06-24T18:47:23-0400","dateStarted":"2017-06-24T19:17:03-0400","dateFinished":"2017-06-24T19:17:11-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6988"},{"text":"%md\n## Final Model","user":"anonymous","dateUpdated":"2017-06-24T18:55:45-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Final Model</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1498344890017_-573062442","id":"20170624-185450_1968505270","dateCreated":"2017-06-24T18:54:50-0400","dateStarted":"2017-06-24T18:55:45-0400","dateFinished":"2017-06-24T18:55:46-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6989"},{"text":"import org.apache.spark.ml.classification.LogisticRegressionModel\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.Row\n\nval bestModel =  cvModel.bestModel.asInstanceOf[LogisticRegressionModel]\n\nprintln(\"Model Intercept = \"+ bestModel.intercept)\nval coefficients = bestModel.coefficients.toArray\n\ncase class Record(weightFeature: Double)\n\nval weightsDF = sqlContext.createDataFrame(coefficients.map(i => Record(i)))\nweightsDF.show()","user":"anonymous","dateUpdated":"2017-06-24T20:57:55-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.classification.LogisticRegressionModel\n\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.sql.Row\n\nbestModel: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_8d2f40e33fa4\nModel Intercept = -1.4693408584141938\ncoefficients: Array[Double] = Array(-0.11167415325935548, -0.036139489139454195, 0.031753027189622175, 0.01500984852320047, 0.025277092125650196, 0.015367771766513156, 0.008719659933280418, -0.01720126306690325, -0.01877462609980798, -0.007049751245108695, -0.0306596965634576, 0.15537813764692018, 0.06204648617477265, -0.042901665987943406, 0.024379166411390665, -0.05446322979853842, -0.02784979289319753, -0.08801858333327651, -0.0754825146535164, 0.002156009519959373, -0.01109840136165527, 0.0344167558839711, -0.012660206204505604, -0.03340063321827532, 0.02211265018546091, -0.013709255812068872, 0.004293567824532161, 0.01727189121174578, -0.01887697868478125, 0.011341672718459792, -3.162363591439353E-5, 0.010499412044364049, -0.016298556954253675, 0.007078539129369436, -0.012694267554...\ndefined class Record\n\nweightsDF: org.apache.spark.sql.DataFrame = [weightFeature: double]\n+--------------------+\n|       weightFeature|\n+--------------------+\n|-0.11167415325935548|\n|-0.03613948913945...|\n|0.031753027189622175|\n| 0.01500984852320047|\n|0.025277092125650196|\n|0.015367771766513156|\n|0.008719659933280418|\n|-0.01720126306690325|\n|-0.01877462609980798|\n|-0.00704975124510...|\n| -0.0306596965634576|\n| 0.15537813764692018|\n| 0.06204648617477265|\n|-0.04290166598794...|\n|0.024379166411390665|\n|-0.05446322979853842|\n|-0.02784979289319753|\n|-0.08801858333327651|\n| -0.0754825146535164|\n|0.002156009519959373|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1498344950379_1908876092","id":"20170624-185550_1614567507","dateCreated":"2017-06-24T18:55:50-0400","dateStarted":"2017-06-24T19:54:40-0400","dateFinished":"2017-06-24T19:54:43-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6990"},{"dateUpdated":"2017-06-24T11:20:15-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1498317615265_-823265545","id":"20170428-141600_2030210543","dateCreated":"2017-06-24T11:20:15-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6991"}],"name":"Lending_ML","id":"2CJX1TKRK","angularObjects":{"2CEURCNS5:shared_process":[],"2CEHKHCPE:shared_process":[],"2CGX2Y3R2:shared_process":[],"2CFBKQXH4:shared_process":[],"2CEY5B7AM:shared_process":[],"2CER83XV7:shared_process":[],"2CH9N6G8T:shared_process":[],"2CE2R6ZXV:shared_process":[],"2CHJXJECX:shared_process":[],"2CF5A8YTG:shared_process":[],"2CFFY1ZBD:shared_process":[],"2CEDENB37:shared_process":[],"2CH7BUMV7:shared_process":[],"2CHEYB9HP:shared_process":[],"2CHMR72BU:shared_process":[],"2CEGKHCNC:shared_process":[],"2CE2V9DPY:shared_process":[],"2CG77514Z:shared_process":[],"2CEN779XY:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}